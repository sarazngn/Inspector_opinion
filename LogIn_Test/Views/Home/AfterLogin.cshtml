@model IEnumerable<LogIn_Test.Models.PM_vw_InspectorView>

@{
    Layout = null;
}
<!DOCTYPE html>
<html dir="rtl" style = "font-family:IRANSans,garamond,serif;font-size:14px;">
<style dir="rtl" ; style="float:right">

    fieldset {
        background-color: #eeeeee;
    }

    legend {
        background-color: gray;
        color: white;
        padding: 5px 10px;
    }

    input {
        margin: 5px;
    }
</style>

<head>

    <link rel="stylesheet" type="text/css" href="~/Content/Themes/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="~/Content/Themes/responsive.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="~/Content/Themes/notyf.min.css">

    <script type="text/javascript" language="javascript" src="~/Scripts/jquery-3.5.1.js"></script>
    <script type="text/javascript" language="javascript" src="~/Scripts/jquery.dataTables.min.js"></script>
    <script src="~/Scripts/dataTables.responsive.min.js" type="text/javascript"></script>
    <script src="~/Scripts/notyf.min.js" type="text/javascript"></script>

</head>
<body class="wide comments example">
    <a name="top" id="top"></a>
    <div class="fw-background">
        <br /><br />
        <fieldset>
            <legend">
                اعلام نظر بازرس
                </legend>
                <br /><br />
                @Html.Label("OpinionLabel", "تائید", new { style = "float:right;margin-right: 10px"})
                @Html.RadioButton("Opinion", "1",new { @checked = "checked" , style = "float:right" } )
                @Html.Label("OpinionLabel", "عدم تائید", new { style = "float:right;margin-right: 20px" })
                @Html.RadioButton("Opinion", "0", new { style = "float:right" })
                @Html.Label("Desc", "توضیحات", new { style = "float:right;margin-top;margin-right: 50px" })
                @Html.TextArea("Description", new { style = "float:right;margin-top;margin-left: 10px;width=1000px" })
                <button type="submit" value="Delete" style="margin-left: 10px;font-family:IRANSans,garamond,serif;font-size:14px" class="btn btn-sm btn-info rounded-0" onclick="GetSelected()"><i class="fa fa-trash-o"></i> ثبت</button>
                <br /><br />
        </fieldset>

        <div></div>
    </div>
    <div class="fw-container">
        <div class="fw-body">
            <div class="content">
                <h3 class="page_title">برنامه های انجام شده</h3>

                <div class="demo-html">
                    <table id="example" class="display nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th><input type="checkbox" id="checkBoxAll" class="custom-checkbox" onclick="for(c in document.getElementsByName('ID')) document.getElementsByName('ID').item(c).checked = this.checked" /></th>
                                <th>شماره تیکت</th>
                                <th>نوع_فعالیت</th>
                                <th>عنوان_برنامه</th>
                                <th>مجری</th>
                                <th>زمان_مناسب_انجام_کار</th>
                                <th>نتیجه</th>
                                <th>تاریخ_اعلام_نتیجه</th>
                                <th>کاربر_ثبت_کننده_نتیجه</th>
                                <th>تاریخ_ثبت_نتیجه</th>
                                <th>مقدار_جدید</th>
                                <th>آیا_ریست_شده</th>
                                <th>توضیحات</th>
                                <th>نام_ماشین</th>
                                <th>کد_ماشین</th>
                                <th>کارگاه</th>
                                <th>محل استقرار</th>
                                <th>آخرین_مقدار</th>
                                <th>واحد_مقدار</th>
                                <th>نظر_بازرس</th>
                                <th>کاربر_بازرس</th>
                                <th>تاریخ_ثبت_نظر_بازرس</th>
                                <th>توضیحات_بازرس</th>
                                <th style="display:none">ردیف</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var Inspector in Model)
                            {
                            <tr>
                                <td></td>
                                <td><input type="checkbox" name="ID" value="@Inspector.Sent_ID" class="custom-checkbox chkCheckBoxId" /></td>

                                <td>@Inspector.شماره_تیکت</td>
                                <td>@Inspector.نوع_فعالیت</td>
                                <td>@Inspector.عنوان_برنامه</td>
                                <td>@Inspector.مجری</td>
                                <td>@Inspector.زمان_مناسب_انجام_کار</td>
                                <td>@Inspector.نتیجه</td>
                                <td>@Inspector.تاریخ_اعلام_نتیجه</td>
                                <td>@Inspector.کاربر_ثبت_کننده_نتیجه</td>
                                <td>@Inspector.تاریخ_اعلام_نتیجه</td>
                                <td>@Inspector.مقدار_جدید</td>
                                <td>@Inspector.آیا_ریست_شده</td>
                                <td>@Inspector.توضیحات</td>
                                <td>@Inspector.نام_ماشین</td>
                                <td>@Inspector.کد_ماشین</td>
                                <td>@Inspector.کارگاه</td>
                                <td>@Inspector.محل_استقرار</td>
                                <td>@Inspector.آخرین_مقدار</td>
                                <td>@Inspector.واحد_مقدار</td>
                                <td>@Inspector.نظر_بازرس</td>
                                <td>@Inspector.کاربر_بازرس</td>
                                <td>@Inspector.تاریخ_ثبت_نظر_بازرس</td>
                                <td>@Inspector.توضیحات_بازرس</td>
                                <td style="display:none">@Inspector.Sent_ID</td>

                            </tr>
                            }
                    </table>

                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">

        function GetSelected() {
            //Reference the Table.
            var grid = document.getElementById("example");
            var notyf = new Notyf({position: {x: 'right', y: 'top', }});
            //Reference the CheckBoxes in Table.
            var checkBoxes = grid.getElementsByTagName("INPUT");
            var selectedOrderTypeVal = $('[name=Opinion]:checked').val();
            var array = []
            //Loop through the CheckBoxes.
            for (var i = 1; i < checkBoxes.length; i++) {
                if (checkBoxes[i].checked) {
                    var row = checkBoxes[i].parentNode.parentNode;
                    array.push(row.cells[2].innerHTML);
                }
            }

            if (array.length == 0) { notyf.error('برنامه ای برای ثبت نظر انتخاب نشده است'); }
            else {//فراخوانی وب سرویس
                //notyf.success(Description.value + " " + selectedOrderTypeVal + " " + array.length);
                CallWebService();
            }
    }

        function CallWebService() {
        $.ajax({  
            type: "POST",  
            url: "https://localhost:44310/PM_Results/PM_InspectorOpenion/SavePMInspector",  
            data: "{'Description':'selectedOrderTypeVal':'array'}",  
            contentType: "application/json",  
            datatype: "json",  
            success: function(responseFromServer) {  
                alert(responseFromServer.d)  
            }  
        });  
};  


    $(document).ready(function () {
        $('#example').DataTable({
            responsive: {
                details: {
                    renderer: function (api, rowIdx, columns) {
                        var data = $.map(columns, function (col, i) {
                            return col.hidden ?
                                '<tr data-dt-row="' + col.rowIndex + '" data-dt-column="' + col.columnIndex + '">' +
                                '<td>' + col.title + ':' + '</td> ' +
                                '<td>' + col.data + '</td>' +
                                '</tr>' :
                                '';
                        }).join('');

                        return data ?
                            $('<table/>').append(data) :
                            false;
                    }
                }
            }
        });
    });


    </script>
</body>

</html>
<footer>
    <br />
    @Html.Label("Loged In User", "کاربر جاری: ", new { style = "float:right;margin-right: 10px" })
    @ViewBag.LogedUser <br />
    @Html.Label("Loged In Date", "زمان ورود: ", new { style = "float:right;margin-right: 10px" })
    @DateTime.Now
</footer>